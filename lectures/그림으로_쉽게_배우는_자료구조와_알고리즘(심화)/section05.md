## 💻 Red-Black 트리

### 📌 개념

#### 삽입

-   AVL 트리는 균형을 엄격히 지키기 때문에 삽입, 제거는 느리지만 검색이 빠름
-   Red-Black 트리는 균형에 대해 관대하여 삽입, 제거는 빠르지만 검색이 느림

규칙

1. 모든 노드는 빨간색이나 검은색 두 가지 색 중 하나이다
2. 루트 노드는 항상 검은색이다
3. 모든 터미널 노드(NIL)는 검정색이다
4. 연속해서 빨간색 노드가 올 수 없다.
    1. 현재 노드가 빨간색이라면 부모, 자식은 빨간색일 수 없음
5. 검은색은 연속으로 올 수 있다
6. 루트 노드에서 터미널 노드인 NIL노드까지 모든 경로에는 같은 수의 검은색 노드가 있어야 한다.

높이

-   1. 트리의 높이
-   2. Black Height: 루트부터 NIL 노드까지 Black 노드의 수

삽입을 할 때 회전도 하지만 노드의 색도 다시 칠해준다. (recoloring)
새로운 노드를 삷입할 때 무조건 빨간 색 노드를 칠한다.
이 후 균형을 잡아주는 함수를 호출(rebalanceAfterInsertion 함수)

1. 새로운 노드가 루트노드인 경우
    1. 검정색으로 변경
2. 부모노드와 삼촌노드가 빨간색인 경우
    1. 삼촌노드: 부모의 형제 노드
    2. 할아버지를 빨간색으로, 부모/삼촌 노드를 검정색으로 변경
    3. 규칙을 위반하지 않을 때까지 재귀적으로 상위로 올라감
3. 부모는 빨간색, 삼촌은 검정색, 새로운 노드는 안쪽 손자인 경우
    1. 안쪽 손자: 할아버지, 부모, 자신이 삼각형을 이루는 노드 (RL)
    2. 부모 노드를 회전, 할아버지 노드는 반대 회전
    3. 새로 삽입된 노드는 검은색, 할아버지 노드는 빨간색으로 변경
4. 부모 빨간색, 삼촌 검정색, 새로운 노드가 바깥쪽 손자인 경우
    1. 바깥쪽 손자: 할아버지, 부모, 자신이 일자를 이루는 노드(LL)
    2. 할아버지노드는 삽입 방향 반대로 회전
    3. 부모 노드는 검정, 할아버지 노드는 빨강으로 변경

#### 제거

규칙

1. 터미널 노드를 제거
    1. 제거할 노드의 두 자식 노드가 모두 NIL인 경우
        1. 해당 노드 제거 후 부모 노드를 NIL에 연결
    2. 제거할 노드의 자식 노드 중 하나가 NIL
        1. 해당 노드 제거 후 부모 노드에 나머지 노드 연결
    3. 제거할 노드의 자식노드에 NIL이 없음
        1. 왼쪽 자식 노드의 큰 값 혹은 오른쪽 자식 노드의 작은 값으로 대체
        2. 대체한 후 나머지 자식노드를 대체 노드의 자식으로 연결
        3. 제거한 노드가 빨간색인 경우에는 색 규칙이 올바름
        4. 검은색이라면 균형을 잡아야 함

균형을 잡는 방법

1. 형제 노드가 빨간색인 경우
    1. 형제 노드의 색을 검정, 부모노드를 빨간색으로 변경
    2. 부모노드 왼쪽 회전, 부모노드를 검정색으로, 형제 노드를 빨간색으로 변경
2. 형제노드와 형제노드의 자식노드들이 검은색이고 부모노드는 빨간색
    1. 형제 노드 빨간색, 부모 노드 검은색
3. 형제노드와 형제노드의 자식노드, 부모 노드 모두 검정색
    1. 형제노드의 색을 빨간색으로 변경
    2. 부모노드에 대해 2번 규칙 적용
4. 형제노드가 검은색, 형제 두 자식 노드 중 하나라도 빨간색 노드가 있고 바깥쪽 조카 노드가 검은 색인 경우
    1. 안쪽 조카는 검정, 형제 노드는 빨간색
    2. 형제 노드를 제거한 노드의 반대방향으로 회전
    3. 조카노드와 부모, 형제 노드 색 변경
    4. 부모 노드 제거 노드 반대방향으로 회전
5. 형제 노드가 검은색이고 형제의 두 자식노드 중 하나라도 빨간색 노드가 있고 바깥쪽 조카가 빨간색인 경우
    1. 형제 노드를 부모 노드 색으로 변경
    2. 부모노드와 바깥쪽 조카 노드 색 변경
    3. 부모 노드를 제거된 노드의 방향으로 변경

출처: [그림으로 쉽게 배우는 자료구조와 알고리즘 (심화편)](https://www.inflearn.com/course/%EA%B7%B8%EB%A6%BC%EC%9C%BC%EB%A1%9C-%EC%89%BD%EA%B2%8C-%EC%9E%90%EB%A3%8C%EA%B5%AC%EC%A1%B0-%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98-%EC%8B%AC%ED%99%94/dashboard)
